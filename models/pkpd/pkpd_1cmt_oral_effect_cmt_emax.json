{
  "name": "pkpd_1cmt_oral_effect_cmt_emax",
  "category": "pkpd",
  "description": "1-CMT oral PK + effect compartment Emax PD \u2014 hysteresis model",
  "monolix_equivalent": "oral1_1cpt_kaVCl_effectCpt_Emax",
  "code": "pkpd_1cmt_oral_effect_cmt_emax <- function() {\n  ini({\n    lka   <- log(1);   label(\"Absorption rate constant (1/h)\")\n    lcl   <- log(5);   label(\"Clearance (L/h)\")\n    lv    <- log(50);  label(\"Volume (L)\")\n    lke0  <- log(0.5); label(\"Effect compartment rate (1/h)\")\n    lE0   <- log(10);  label(\"Baseline effect\")\n    lEmax <- log(50);  label(\"Maximum drug effect\")\n    lEC50 <- log(5);   label(\"EC50 (mg/L)\")\n    eta.ka   ~ 0.3\n    eta.cl   ~ 0.1\n    eta.v    ~ 0.1\n    eta.E0   ~ 0.1\n    prop.sd.pk <- 0.2\n    add.sd.pd  <- 5\n  })\n  model({\n    ka   <- exp(lka  + eta.ka)\n    cl   <- exp(lcl  + eta.cl)\n    v    <- exp(lv   + eta.v)\n    ke0  <- exp(lke0)\n    E0   <- exp(lE0  + eta.E0)\n    Emax <- exp(lEmax)\n    EC50 <- exp(lEC50)\n    d/dt(depot)   = -ka * depot\n    d/dt(central) =  ka * depot - cl/v * central\n    d/dt(Ce)      =  ke0 * (central/v - Ce)\n    Cc = central / v\n    E  = E0 + Emax * Ce / (EC50 + Ce)\n    Cc ~ prop(prop.sd.pk)\n    E  ~ add(add.sd.pd)\n  })\n}"
}